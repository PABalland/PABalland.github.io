590+1000+500+590+620+690
1300/3900
590+1000+500+590+620+690/2
339.00/2
35/135
6382.24
6382.24/2
45*3
6000000*0.01
5000*50
35665/42559
6894/42559
35665*0.7
(35665/2)*0.7
(35665/2)*(1-0.075)
library (EconGeo)
library(Hmisc)
library(dplyr)
dir = "C:/Dropbox/2-private/1-asg/1-production/3-projects/6-bertelsmann-stiftung"
setwd("C:/Dropbox/2-private/1-asg/1-production/2-code/d3plus-geomap")
source ("d3plus.geomap.R")
library(EconGeo)
library(Hmisc)
library(dplyr)
library(jsonlite)
# read data
### NET
setwd(paste0(dir, "/3-outputs"))
df = read.csv2("untapped-4.csv")
# test with other untapped
test = read.csv2("untapped-3.csv")[, c("reg1", "reg2", "tech", "untapped")]
test <- merge(test, df, by = c("reg1", "reg2", "tech"), using = "data.table")
cor(test$untapped.x, test$untapped.y)
test = subset (df, df$tech == "Photonics")
df$value = df$untapped
df$id = paste0(df$name.y, "(", df$reg2, ")")
df$name = paste0(df$name.y, "(", df$reg2, ")")
df$y = df$rscount
df$x = df$rspred
df$parent = df$tech
df$color = "green"
i = paste0(df$reg1, df$tech)
i = iconv(i, to = 'ASCII//TRANSLIT')
i = gsub(" ", "-", i, fixed = TRUE)
i = gsub("/", "-", i, fixed = TRUE)
i = gsub(",", "-", i, fixed = TRUE)
i = gsub("(", "-", i, fixed = TRUE)
i = gsub(")", "", i, fixed = TRUE)
i = gsub("--", "-", i, fixed = TRUE)
i = gsub("-.", ".", i, fixed = TRUE)
i = tolower (i)
df$CID = i
i = "be33photonics"
#i = "fi195g"
#i = "dea5hydrogen"
#i = "es61virtual-reality-and-augmented-reality"
#i = "pl21autonomous-mobility"
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
#values = paste0("https://www.paballand.com/asg/bertelsmann-stiftung/json/", paste0("untapped-map-", i,  ".json"))
#topo = "https://www.paballand.com/json/topojson/NUTS_RG_20M_2010_4326-nuts-2-regpat.json"
#dir2 = paste0(dir, "/3-outputs/8-untapped-maps")
#as = paste0("untapped-map-", i)
#d3plus.geomap(sourcehtml = "C:/Dropbox/2-private/1-asg/1-production/2-code/d3plus-geomap/_source",
# topo, values,
#dir = dir2,
# as = as)
i = "fi195g"
#i = "dea5hydrogen"
#i = "es61virtual-reality-and-augmented-reality"
#i = "pl21autonomous-mobility"
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
i = "dea5hydrogen"
#i = "es61virtual-reality-and-augmented-reality"
#i = "pl21autonomous-mobility"
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
i = "es61virtual-reality-and-augmented-reality"
#i = "pl21autonomous-mobility"
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
i = "pl21autonomous-mobility"
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
#values = paste0("https://www.paballand.com/asg/bertelsmann-stiftung/json/", paste0("untapped-map-", i,  ".json"))
#topo = "https://www.paballand.com/json/topojson/NUTS_RG_20M_2010_4326-nuts-2-regpat.json"
#dir2 = paste0(dir, "/3-outputs/8-untapped-maps")
#as = paste0("untapped-map-", i)
#d3plus.geomap(sourcehtml = "C:/Dropbox/2-private/1-asg/1-production/2-code/d3plus-geomap/_source",
# topo, values,
#dir = dir2,
# as = as)
cidlist = c("be33photonics",
"fi195g",
"dea5hydrogen",
"es61virtual-reality-and-augmented-reality",
"pl21autonomous-mobility")
for (i in cidlist) {
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
#values = paste0("https://www.paballand.com/asg/bertelsmann-stiftung/json/", paste0("untapped-map-", i,  ".json"))
#topo = "https://www.paballand.com/json/topojson/NUTS_RG_20M_2010_4326-nuts-2-regpat.json"
#dir2 = paste0(dir, "/3-outputs/8-untapped-maps")
#as = paste0("untapped-map-", i)
#d3plus.geomap(sourcehtml = "C:/Dropbox/2-private/1-asg/1-production/2-code/d3plus-geomap/_source",
# topo, values,
#dir = dir2,
# as = as)
}
cidlist = c("be33photonics",
"fi195g",
"dea5hydrogen",
"es61virtual-reality-and-augmented-reality",
"pl21autonomous-mobility")
for (i in cidlist) {
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
#values = paste0("https://www.paballand.com/asg/bertelsmann-stiftung/json/", paste0("untapped-map-", i,  ".json"))
#topo = "https://www.paballand.com/json/topojson/NUTS_RG_20M_2010_4326-nuts-2-regpat.json"
#dir2 = paste0(dir, "/3-outputs/8-untapped-maps")
#as = paste0("untapped-map-", i)
#d3plus.geomap(sourcehtml = "C:/Dropbox/2-private/1-asg/1-production/2-code/d3plus-geomap/_source",
# topo, values,
#dir = dir2,
# as = as)
}
i
df2 = subset (df, df$CID == i)
df2$value[df2$count>0]=100 # value untapped
df2$status = paste0("Unrealized potential = ", df2$untapped)
df2$status[df2$count>0] = paste0("Number of links = ", df2$count[df2$count>0])
df2 = subset (df2, df2$id != "EL62")
df2 = subset (df2, df2$id != "ES64")
df2$nuts2 = df2$reg2
df2$nuts_name = df2$name.y
df2$id = df2$reg2
#c("nuts2", "nuts2_name", "tech", "count", "rca", "rel", "comp", "name", "parent", "id", "value")
df2 = toJSON(df2)
setwd("C:/Dropbox/2-private/PABalland.github.io/asg/bertelsmann-stiftung/json")
write(df2, paste0("untapped-map-", i,  ".json"))
