<!doctype html>
<html>

  <head>

    <meta charset="utf-8">
    <title>Forced Network</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>

    <style>

      html, body {
        margin: 0;
        height: 100%;
        font-family: "Avenir Next", "Helvetica Neue", Arial, sans-serif;
        background: #f5f7fa;
      }

      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #legend-container {
        flex: 0 0 5vh;
        max-height: 5vh;
        min-height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: clamp(8px, 2vh, 16px) clamp(16px, 4vw, 32px);
        background: rgba(255, 255, 255, 0.96);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.07);
        order: 2;
      }

      .custom-legend {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
        gap: clamp(8px, 1.5vw, 16px);
        width: 100%;
        max-height: 100%;
        overflow: auto;
        scrollbar-width: thin;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        color: #1b1d21;
        font-size: clamp(12px, 1.3vw, 16px);
        cursor: default;
        white-space: nowrap;
      }

      .legend-item.dim {
        opacity: 0.35;
      }

      .legend-square {
        width: clamp(12px, 1.2vw, 16px);
        height: clamp(12px, 1.2vw, 16px);
        border-radius: 4px;
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.12) inset;
      }

      .legend-label {
        pointer-events: none;
      }

      svg.network {
        flex: 1 1 auto;
        width: 100%;
        height: 100%;
        display: block;
        cursor: move;
        background: #ffffff;
        order: 1;
      }

      .link {
        stroke: rgba(140, 150, 170, 0.45);
      }

      .link.highlighted {
        stroke: rgba(80, 90, 110, 0.9);
        stroke-width: 6px;
      }

      .link.dimmed {
        opacity: 0.2;
      }

      .node.dimmed {
        opacity: 0.25;
      }

      .node.highlighted circle {
        stroke-width: 3px;
      }

      .node.highlighted text {
        font-weight: 700;
      }

      .node circle {
        stroke: #ffffff;
        stroke-width: 2px;
      }

      .node text {
        font-weight: 400;
        text-anchor: middle;
        dominant-baseline: central;
        pointer-events: none;
        font-family: "Helvetica Neue", Arial, sans-serif;
      }

    </style>

  </head>

  <body>

    <div id="legend-container">
      <div class="custom-legend" id="legend"></div>
    </div>

    <svg class="network"></svg>

    <script>

      var nodes =  [{"id":"Advanced Manufacturing","id2":0,"x":0.601,"y":-0.1761,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Advanced Materials","id2":1,"x":0.5414,"y":0.9248,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Advanced Therapy Medicinal Products (ATMP)","id2":2,"x":0.2019,"y":3.1063,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Artificial Intelligence","id2":3,"x":0.1546,"y":-2.4025,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Autonomous Robots","id2":4,"x":-1.5316,"y":-2.4092,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Bioinformatics","id2":5,"x":0.352,"y":5.2281,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Biomanufacturing","id2":6,"x":-0.428,"y":2.1659,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Biotechnology","id2":7,"x":-0.8387,"y":3.3751,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Carbon Capture & Storage","id2":36,"x":1.7854,"y":0.6321,"color":"#8cab79","parent":"Energy & Climate","size":1.5},{"id":"Cloud and Edge Computing","id2":8,"x":1.198,"y":-3.324,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Cybersecurity","id2":21,"x":0.4607,"y":-3.3879,"color":"#e28f26","parent":"Security & Space","size":1.5},{"id":"Defence Technologies","id2":9,"x":-2.5283,"y":-1.7677,"color":"#e28f26","parent":"Security & Space","size":1.5},{"id":"Drones","id2":16,"x":-2.3717,"y":-2.2239,"color":"#e28f26","parent":"Security & Space","size":1.5},{"id":"Food Technology","id2":35,"x":-1.651,"y":4.0405,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Generative AI","id2":30,"x":-0.7603,"y":-2.9009,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Genomics & Gene Editing","id2":10,"x":-0.228,"y":3.215,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"High-Performance Computing (HPC)","id2":24,"x":0.9004,"y":-2.5005,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Immunotherapy","id2":29,"x":-0.6448,"y":4.3873,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Internet of Things (IOT)","id2":19,"x":1.1269,"y":-1.895,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Medical Devices","id2":27,"x":-0.3368,"y":1.0785,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Microelectronics","id2":11,"x":0.3929,"y":-0.6016,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"mRNA Technology","id2":23,"x":-0.0262,"y":4.192,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Nanotechnologies","id2":12,"x":0.1354,"y":1.2007,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Natural Language Processing","id2":17,"x":0.1709,"y":-4.3268,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Nuclear Energy","id2":13,"x":2.5992,"y":-0.0046,"color":"#8cab79","parent":"Energy & Climate","size":1.5},{"id":"Pharmaceuticals","id2":32,"x":-1.5857,"y":4.9635,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Photonics","id2":14,"x":-0.3718,"y":-0.6214,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Precision Medicine","id2":25,"x":-0.3043,"y":5.174,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Quantum computing","id2":20,"x":-0.8169,"y":-2.1091,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Regenerative Medicine","id2":26,"x":0.3582,"y":2.0773,"color":"#800020","parent":"Health & Biotech","size":1.5},{"id":"Robotics","id2":18,"x":-0.8827,"y":-0.9488,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Semiconductors","id2":22,"x":0.775,"y":0.2999,"color":"#365a94","parent":"Digital & AI","size":1.5},{"id":"Sensor Technologies","id2":31,"x":0.0618,"y":-0.1717,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Smart Grids","id2":15,"x":2.7712,"y":-1.7725,"color":"#8cab79","parent":"Energy & Climate","size":1.5},{"id":"Smart Materials","id2":28,"x":-0.4576,"y":0.3717,"color":"#669999","parent":"Advanced Industry & Materials","size":1.5},{"id":"Space technologies","id2":33,"x":-1.9853,"y":-0.7013,"color":"#e28f26","parent":"Security & Space","size":1.5},{"id":"Waste Management","id2":34,"x":2.5273,"y":1.1405,"color":"#8cab79","parent":"Energy & Climate","size":1.5},{"id":"Wind Energy","id2":37,"x":2.1535,"y":-2.9899,"color":"#8cab79","parent":"Energy & Climate","size":1.5}]  ;

      var links =   [{"source":"Advanced Manufacturing","target":"Advanced Materials","weight":17.6},{"source":"Advanced Manufacturing","target":"Carbon Capture & Storage","weight":3.31},{"source":"Advanced Manufacturing","target":"Robotics","weight":15.84},{"source":"Advanced Materials","target":"Medical Devices","weight":24.68},{"source":"Advanced Materials","target":"Microelectronics","weight":16.84},{"source":"Advanced Materials","target":"Nanotechnologies","weight":34.47},{"source":"Advanced Materials","target":"Nuclear Energy","weight":7.83},{"source":"Advanced Materials","target":"Smart Materials","weight":24.48},{"source":"Advanced Materials","target":"Waste Management","weight":6.13},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"Immunotherapy","weight":24.04},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"mRNA Technology","weight":33.17},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"Regenerative Medicine","weight":13.02},{"source":"Artificial Intelligence","target":"Cybersecurity","weight":37.72},{"source":"Artificial Intelligence","target":"Natural Language Processing","weight":52.44},{"source":"Artificial Intelligence","target":"Quantum computing","weight":38.26},{"source":"Artificial Intelligence","target":"Autonomous Robots","weight":13.75},{"source":"Autonomous Robots","target":"Drones","weight":5.99},{"source":"Autonomous Robots","target":"Robotics","weight":48.11},{"source":"Bioinformatics","target":"Genomics & Gene Editing","weight":17.3},{"source":"Biomanufacturing","target":"Medical Devices","weight":13.91},{"source":"Biomanufacturing","target":"Regenerative Medicine","weight":24.91},{"source":"Biotechnology","target":"Food Technology","weight":4.96},{"source":"Biotechnology","target":"Pharmaceuticals","weight":7.02},{"source":"Cloud and Edge Computing","target":"Cybersecurity","weight":12.47},{"source":"Cloud and Edge Computing","target":"High-Performance Computing (HPC)","weight":32.85},{"source":"Cloud and Edge Computing","target":"Internet of Things (IOT)","weight":47.65},{"source":"Defence Technologies","target":"Drones","weight":64.24},{"source":"Artificial Intelligence","target":"Generative AI","weight":17.41},{"source":"Genomics & Gene Editing","target":"mRNA Technology","weight":27.05},{"source":"Genomics & Gene Editing","target":"Precision Medicine","weight":30.23},{"source":"Microelectronics","target":"Semiconductors","weight":36.49},{"source":"Biotechnology","target":"mRNA Technology","weight":13.57},{"source":"Nanotechnologies","target":"Sensor Technologies","weight":14.01},{"source":"Nuclear Energy","target":"Smart Grids","weight":6.93},{"source":"Microelectronics","target":"Photonics","weight":23.8},{"source":"Photonics","target":"Space technologies","weight":6.19},{"source":"Smart Grids","target":"Wind Energy","weight":2.68},{"source":"Drones","target":"Defence Technologies","weight":64.24},{"source":"Natural Language Processing","target":"Artificial Intelligence","weight":52.44},{"source":"Robotics","target":"Autonomous Robots","weight":48.11},{"source":"Internet of Things (IOT)","target":"Cloud and Edge Computing","weight":47.65},{"source":"Quantum computing","target":"Artificial Intelligence","weight":38.26},{"source":"Cybersecurity","target":"Artificial Intelligence","weight":37.72},{"source":"Semiconductors","target":"Microelectronics","weight":36.49},{"source":"Nanotechnologies","target":"Advanced Materials","weight":34.47},{"source":"mRNA Technology","target":"Advanced Therapy Medicinal Products (ATMP)","weight":33.17},{"source":"High-Performance Computing (HPC)","target":"Cloud and Edge Computing","weight":32.85},{"source":"Precision Medicine","target":"Genomics & Gene Editing","weight":30.23},{"source":"mRNA Technology","target":"Genomics & Gene Editing","weight":27.05},{"source":"Regenerative Medicine","target":"Biomanufacturing","weight":24.91},{"source":"Medical Devices","target":"Advanced Materials","weight":24.68},{"source":"Smart Materials","target":"Advanced Materials","weight":24.48},{"source":"Immunotherapy","target":"Advanced Therapy Medicinal Products (ATMP)","weight":24.04},{"source":"Photonics","target":"Microelectronics","weight":23.8},{"source":"Nanotechnologies","target":"Medical Devices","weight":22.43},{"source":"Medical Devices","target":"Nanotechnologies","weight":22.43},{"source":"mRNA Technology","target":"Immunotherapy","weight":20.89},{"source":"Immunotherapy","target":"mRNA Technology","weight":20.89},{"source":"Advanced Materials","target":"Advanced Manufacturing","weight":17.6},{"source":"Generative AI","target":"Artificial Intelligence","weight":17.41},{"source":"Genomics & Gene Editing","target":"Bioinformatics","weight":17.3},{"source":"Microelectronics","target":"Advanced Materials","weight":16.84},{"source":"Robotics","target":"Advanced Manufacturing","weight":15.84},{"source":"Smart Materials","target":"Medical Devices","weight":14.33},{"source":"Medical Devices","target":"Smart Materials","weight":14.33},{"source":"Sensor Technologies","target":"Nanotechnologies","weight":14.01},{"source":"Medical Devices","target":"Biomanufacturing","weight":13.91},{"source":"Autonomous Robots","target":"Artificial Intelligence","weight":13.75},{"source":"mRNA Technology","target":"Biotechnology","weight":13.57},{"source":"Regenerative Medicine","target":"Advanced Therapy Medicinal Products (ATMP)","weight":13.02},{"source":"Semiconductors","target":"Advanced Materials","weight":12.66},{"source":"Advanced Materials","target":"Semiconductors","weight":12.66},{"source":"Robotics","target":"Artificial Intelligence","weight":12.59},{"source":"Artificial Intelligence","target":"Robotics","weight":12.59},{"source":"Cybersecurity","target":"Cloud and Edge Computing","weight":12.47},{"source":"Genomics & Gene Editing","target":"Advanced Therapy Medicinal Products (ATMP)","weight":12.08},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"Genomics & Gene Editing","weight":12.08},{"source":"Sensor Technologies","target":"Advanced Materials","weight":11.71},{"source":"Advanced Materials","target":"Sensor Technologies","weight":11.71},{"source":"Genomics & Gene Editing","target":"Biotechnology","weight":11.51},{"source":"Biotechnology","target":"Genomics & Gene Editing","weight":11.51},{"source":"Semiconductors","target":"Photonics","weight":11.14},{"source":"Photonics","target":"Semiconductors","weight":11.14},{"source":"Internet of Things (IOT)","target":"High-Performance Computing (HPC)","weight":10.67},{"source":"High-Performance Computing (HPC)","target":"Internet of Things (IOT)","weight":10.67},{"source":"Internet of Things (IOT)","target":"Cybersecurity","weight":10.56},{"source":"Cybersecurity","target":"Internet of Things (IOT)","weight":10.56},{"source":"Regenerative Medicine","target":"Advanced Materials","weight":9.4},{"source":"Advanced Materials","target":"Regenerative Medicine","weight":9.4},{"source":"Photonics","target":"Advanced Materials","weight":9.38},{"source":"Advanced Materials","target":"Photonics","weight":9.38},{"source":"Microelectronics","target":"Medical Devices","weight":9.31},{"source":"Medical Devices","target":"Microelectronics","weight":9.31},{"source":"Regenerative Medicine","target":"Medical Devices","weight":8.23},{"source":"Medical Devices","target":"Regenerative Medicine","weight":8.23},{"source":"Quantum computing","target":"Photonics","weight":8.21},{"source":"Photonics","target":"Quantum computing","weight":8.21},{"source":"Photonics","target":"Medical Devices","weight":7.87},{"source":"Medical Devices","target":"Photonics","weight":7.87},{"source":"Nuclear Energy","target":"Advanced Materials","weight":7.83},{"source":"Nanotechnologies","target":"Microelectronics","weight":7.3},{"source":"Microelectronics","target":"Nanotechnologies","weight":7.3},{"source":"High-Performance Computing (HPC)","target":"Artificial Intelligence","weight":7.22},{"source":"Artificial Intelligence","target":"High-Performance Computing (HPC)","weight":7.22},{"source":"Robotics","target":"Medical Devices","weight":7.11},{"source":"Medical Devices","target":"Robotics","weight":7.11},{"source":"Pharmaceuticals","target":"Biotechnology","weight":7.02},{"source":"Genomics & Gene Editing","target":"Advanced Materials","weight":6.94},{"source":"Advanced Materials","target":"Genomics & Gene Editing","weight":6.94},{"source":"Smart Grids","target":"Nuclear Energy","weight":6.93},{"source":"Generative AI","target":"Autonomous Robots","weight":6.84},{"source":"Autonomous Robots","target":"Generative AI","weight":6.84},{"source":"Biomanufacturing","target":"Advanced Materials","weight":6.72},{"source":"Advanced Materials","target":"Biomanufacturing","weight":6.72},{"source":"Immunotherapy","target":"Genomics & Gene Editing","weight":6.62},{"source":"Genomics & Gene Editing","target":"Immunotherapy","weight":6.62},{"source":"Sensor Technologies","target":"Medical Devices","weight":6.53},{"source":"Medical Devices","target":"Sensor Technologies","weight":6.53},{"source":"Immunotherapy","target":"Biotechnology","weight":6.49},{"source":"Biotechnology","target":"Immunotherapy","weight":6.49},{"source":"Smart Materials","target":"Nanotechnologies","weight":6.3},{"source":"Nanotechnologies","target":"Smart Materials","weight":6.3},{"source":"Space technologies","target":"Photonics","weight":6.19},{"source":"Waste Management","target":"Advanced Materials","weight":6.13},{"source":"Photonics","target":"Artificial Intelligence","weight":6.12},{"source":"Artificial Intelligence","target":"Photonics","weight":6.12},{"source":"Drones","target":"Autonomous Robots","weight":5.99},{"source":"Defence Technologies","target":"Autonomous Robots","weight":5.9},{"source":"Autonomous Robots","target":"Defence Technologies","weight":5.9},{"source":"Robotics","target":"Advanced Materials","weight":5.82},{"source":"Advanced Materials","target":"Robotics","weight":5.82},{"source":"Smart Materials","target":"Sensor Technologies","weight":5.51},{"source":"Sensor Technologies","target":"Smart Materials","weight":5.51},{"source":"High-Performance Computing (HPC)","target":"Cybersecurity","weight":5.42},{"source":"Cybersecurity","target":"High-Performance Computing (HPC)","weight":5.42},{"source":"Sensor Technologies","target":"Microelectronics","weight":5.42},{"source":"Microelectronics","target":"Sensor Technologies","weight":5.42},{"source":"Smart Materials","target":"Advanced Manufacturing","weight":5.13},{"source":"Advanced Manufacturing","target":"Smart Materials","weight":5.13},{"source":"Medical Devices","target":"Advanced Manufacturing","weight":5.07},{"source":"Advanced Manufacturing","target":"Medical Devices","weight":5.07},{"source":"Biotechnology","target":"Advanced Therapy Medicinal Products (ATMP)","weight":5.03},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"Biotechnology","weight":5.03},{"source":"Food Technology","target":"Biotechnology","weight":4.96},{"source":"Sensor Technologies","target":"Robotics","weight":4.91},{"source":"Robotics","target":"Sensor Technologies","weight":4.91},{"source":"Robotics","target":"Generative AI","weight":4.79},{"source":"Generative AI","target":"Robotics","weight":4.79},{"source":"Regenerative Medicine","target":"Nanotechnologies","weight":4.71},{"source":"Nanotechnologies","target":"Regenerative Medicine","weight":4.71},{"source":"Medical Devices","target":"Biotechnology","weight":4.67},{"source":"Biotechnology","target":"Medical Devices","weight":4.67},{"source":"Space technologies","target":"Robotics","weight":4.56},{"source":"Robotics","target":"Space technologies","weight":4.56},{"source":"Internet of Things (IOT)","target":"Artificial Intelligence","weight":4.53},{"source":"Artificial Intelligence","target":"Internet of Things (IOT)","weight":4.53},{"source":"Precision Medicine","target":"Bioinformatics","weight":4.42},{"source":"Bioinformatics","target":"Precision Medicine","weight":4.42},{"source":"Cloud and Edge Computing","target":"Artificial Intelligence","weight":4.35},{"source":"Artificial Intelligence","target":"Cloud and Edge Computing","weight":4.35},{"source":"Semiconductors","target":"Nanotechnologies","weight":4.3},{"source":"Nanotechnologies","target":"Semiconductors","weight":4.3},{"source":"Microelectronics","target":"Artificial Intelligence","weight":4.18},{"source":"Artificial Intelligence","target":"Microelectronics","weight":4.18},{"source":"Robotics","target":"Defence Technologies","weight":4.11},{"source":"Defence Technologies","target":"Robotics","weight":4.11},{"source":"Robotics","target":"Drones","weight":4.1},{"source":"Drones","target":"Robotics","weight":4.1},{"source":"Internet of Things (IOT)","target":"Advanced Manufacturing","weight":4.08},{"source":"Advanced Manufacturing","target":"Internet of Things (IOT)","weight":4.08},{"source":"Generative AI","target":"Cybersecurity","weight":4.04},{"source":"Cybersecurity","target":"Generative AI","weight":4.04},{"source":"Medical Devices","target":"Genomics & Gene Editing","weight":3.94},{"source":"Genomics & Gene Editing","target":"Medical Devices","weight":3.94},{"source":"Sensor Technologies","target":"Photonics","weight":3.93},{"source":"Photonics","target":"Sensor Technologies","weight":3.93},{"source":"Biotechnology","target":"Biomanufacturing","weight":3.88},{"source":"Biomanufacturing","target":"Biotechnology","weight":3.88},{"source":"Smart Materials","target":"Robotics","weight":3.84},{"source":"Robotics","target":"Smart Materials","weight":3.84},{"source":"Nanotechnologies","target":"Genomics & Gene Editing","weight":3.74},{"source":"Genomics & Gene Editing","target":"Nanotechnologies","weight":3.74},{"source":"Sensor Technologies","target":"Internet of Things (IOT)","weight":3.71},{"source":"Internet of Things (IOT)","target":"Sensor Technologies","weight":3.71},{"source":"Advanced Therapy Medicinal Products (ATMP)","target":"Advanced Materials","weight":3.7},{"source":"Advanced Materials","target":"Advanced Therapy Medicinal Products (ATMP)","weight":3.7},{"source":"Precision Medicine","target":"Immunotherapy","weight":3.58},{"source":"Immunotherapy","target":"Precision Medicine","weight":3.58},{"source":"Microelectronics","target":"High-Performance Computing (HPC)","weight":3.54},{"source":"High-Performance Computing (HPC)","target":"Microelectronics","weight":3.54},{"source":"Carbon Capture & Storage","target":"Advanced Manufacturing","weight":3.31},{"source":"Carbon Capture & Storage","target":"Advanced Materials","weight":3.01},{"source":"Advanced Materials","target":"Carbon Capture & Storage","weight":3.01},{"source":"Genomics & Gene Editing","target":"Food Technology","weight":1.5},{"source":"Food Technology","target":"Genomics & Gene Editing","weight":1.5},{"source":"Natural Language Processing","target":"Cybersecurity","weight":0.26},{"source":"Cybersecurity","target":"Natural Language Processing","weight":0.26},{"source":"Pharmaceuticals","target":"Immunotherapy","weight":1.56},{"source":"Immunotherapy","target":"Pharmaceuticals","weight":1.56},{"source":"Smart Grids","target":"Internet of Things (IOT)","weight":3.18},{"source":"Internet of Things (IOT)","target":"Smart Grids","weight":3.18},{"source":"Waste Management","target":"Nuclear Energy","weight":2.93},{"source":"Nuclear Energy","target":"Waste Management","weight":2.93},{"source":"Wind Energy","target":"Smart Grids","weight":2.68},{"source":"Wind Energy","target":"Artificial Intelligence","weight":1.16},{"source":"Artificial Intelligence","target":"Wind Energy","weight":1.16}]  ;

      var svg = d3.select("svg.network");
      var svgNode = svg.node();
      var width = (svgNode && svgNode.clientWidth) || window.innerWidth;
      var height = (svgNode && svgNode.clientHeight) || Math.round(window.innerHeight * 0.9);
      var nodeRadius = 48;
      var HOR_PADDING = nodeRadius * 2;
      var padding = nodeRadius * 2;

      var extentX = d3.extent(nodes, function(d) { return d.x; });
      var extentY = d3.extent(nodes, function(d) { return d.y; });

      var availableWidth = Math.max(width - padding * 2, padding);
      var availableHeight = Math.max(height - padding * 2, padding);

      var baseLeft = padding;
      var baseRight = padding + availableWidth;

      var minXBound = baseLeft + HOR_PADDING + nodeRadius;
      var maxXBound = baseRight - HOR_PADDING - nodeRadius;

      if (maxXBound <= minXBound) {
        var midpoint = (baseLeft + baseRight) / 2;
        minXBound = midpoint - 1;
        maxXBound = midpoint + 1;
      }

      var horizontalBounds = {
        min: minXBound,
        max: maxXBound
      };

      var scaleX = d3.scaleLinear()
        .domain(extentX)
        .range([horizontalBounds.min, horizontalBounds.max]);

      var scaleY = d3.scaleLinear()
        .domain(extentY)
        .range([padding, padding + availableHeight]);

      function clampX(value) {
        return Math.max(horizontalBounds.min, Math.min(horizontalBounds.max, value));
      }

      nodes.forEach(function(node) {
        var targetX = clampX(scaleX(node.x));
        var targetY = scaleY(node.y);
        node.originalX = targetX;
        node.originalY = targetY;
        node.x = targetX;
        node.y = targetY;
      });

      svg
        .attr("viewBox", [0, 0, width, height])
        .attr("preserveAspectRatio", "xMidYMid meet");

      var container = svg.append("g");

      var zoomBehavior = d3.zoom()
        .scaleExtent([0.6, 3])
        .on("zoom", function(event) {
          container.attr("transform", event.transform);
        });

      svg.call(zoomBehavior);

      var nodeById = new Map(nodes.map(function(node) {
        return [node.id, node];
      }));

      var linkData = links.map(function(link) {
        return {
          source: nodeById.get(link.source),
          target: nodeById.get(link.target),
          weight: link.weight
        };
      }).filter(function(link) {
        return link.source && link.target;
      });

      var linkExtent = linkData.length ? d3.extent(linkData, function(d) { return d.weight || 1; }) : [1, 1];
      if (linkExtent[0] === linkExtent[1]) {
        linkExtent[1] = linkExtent[0] + 1;
      }

      var linkWidth = d3.scaleSqrt()
        .domain(linkExtent)
        .range([0.6, 4]);

      var link = container.append("g")
        .attr("stroke-linecap", "round")
        .selectAll("line")
        .data(linkData)
        .join("line")
        .attr("class", "link")
        .attr("stroke-width", function(d) { return linkWidth(d.weight || 1); });

      var adjacency = new Map();

      linkData.forEach(function(link) {
        var sourceId = link.source.id;
        var targetId = link.target.id;

        if (!adjacency.has(sourceId)) {
          adjacency.set(sourceId, new Set());
        }

        if (!adjacency.has(targetId)) {
          adjacency.set(targetId, new Set());
        }

        adjacency.get(sourceId).add(targetId);
        adjacency.get(targetId).add(sourceId);
      });

      var node = container.append("g")
        .selectAll("g")
        .data(nodes)
        .join("g")
        .attr("class", "node")
        .call(d3.drag()
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended))
        .on("mouseenter", highlightConnected)
        .on("mouseleave", resetHighlight);

      node.append("circle")
        .attr("r", nodeRadius)
        .attr("fill", function(d) { return d.color; });

      node.append("text")
        .attr("class", "node-label")
        .attr("fill", function(d) {
          return getContrastingTextColor(d.color);
        })
        .style("fill", function(d) {
          return getContrastingTextColor(d.color);
        })
        .call(wrapText, nodeRadius);

      node.append("title")
        .text(function(d) {
          return d.id + (d.parent ? " (" + d.parent + ")" : "");
        });

      renderLegend();

      var simulation = d3.forceSimulation(nodes)
        .alpha(0.9)
        .alphaDecay(0.09)
        .force("collide", d3.forceCollide(nodeRadius + 8).strength(0.95).iterations(4))
        .force("x", d3.forceX(function(d) { return d.originalX; }).strength(1))
        .force("y", d3.forceY(function(d) { return d.originalY; }).strength(1))
        .on("tick", ticked);

      function ticked() {
        nodes.forEach(function(d) {
          d.x = clampX(d.x);
          if (d.fx != null) {
            d.fx = clampX(d.fx);
          }
        });

        link
          .attr("x1", function(d) { return d.source.x; })
          .attr("y1", function(d) { return d.source.y; })
          .attr("x2", function(d) { return d.target.x; })
          .attr("y2", function(d) { return d.target.y; });

        node.attr("transform", function(d) {
          return "translate(" + d.x + "," + d.y + ")";
        });
      }

      function dragstarted(event, d) {
        if (!event.active) {
          simulation.alphaTarget(0.3).restart();
        }
        d.fx = clampX(d.x);
        d.fy = d.y;
      }

      function dragged(event, d) {
        var clampedX = clampX(event.x);
        d.fx = clampedX;
        d.fy = event.y;
        d.x = clampedX;
        d.y = event.y;
      }

      function dragended(event, d) {
        if (!event.active) {
          simulation.alphaTarget(0);
        }
        d.fx = null;
        d.fy = null;
      }

      function darkenColor(hexColor, factor) {
        factor = factor || 0.5;
        var hex = hexColor.trim().replace("#", "");
        if (hex.length === 3) {
          hex = hex.split("").map(function(ch) { return ch + ch; }).join("");
        }

        var r = parseInt(hex.slice(0, 2), 16);
        var g = parseInt(hex.slice(2, 4), 16);
        var b = parseInt(hex.slice(4, 6), 16);

        r = Math.round(r * factor);
        g = Math.round(g * factor);
        b = Math.round(b * factor);

        return "#" + [r, g, b].map(function(val) {
          var hexVal = val.toString(16);
          return hexVal.length === 1 ? "0" + hexVal : hexVal;
        }).join("");
      }

      function highlightConnected(event, nodeDatum) {
        var neighbors = adjacency.get(nodeDatum.id) || new Set();
        var activeIds = new Set(neighbors);
        activeIds.add(nodeDatum.id);

        node.each(function(d) {
          var isActive = activeIds.has(d.id);
          var nodeElement = d3.select(this);
          nodeElement
            .classed("highlighted", isActive)
            .classed("dimmed", !isActive);

          if (isActive) {
            var darkerColor = darkenColor(d.color, 0.6);
            nodeElement.select("circle").style("stroke", darkerColor);
          }
        });

        link.each(function(l) {
          var isActive = l.source.id === nodeDatum.id || l.target.id === nodeDatum.id;
          d3.select(this)
            .classed("highlighted", isActive)
            .classed("dimmed", !isActive);
        });
      }

      function resetHighlight() {
        node.classed("highlighted", false)
          .classed("dimmed", false)
          .select("circle").style("stroke", null);
        link.classed("highlighted", false)
          .classed("dimmed", false);
      }

      function renderLegend() {
        var legend = d3.select("#legend");
        if (legend.empty()) {
          return;
        }

        legend.attr("role", "list");

        var parentColorMap = new Map();
        nodes.forEach(function(node) {
          var parentName = node.parent || "Other";
          if (!parentColorMap.has(parentName)) {
            parentColorMap.set(parentName, node.color || "#6c6f7d");
          }
        });

        var legendData = Array.from(parentColorMap, function(entry) {
          return { parent: entry[0], color: entry[1] };
        });

        var legendItems = legend.selectAll(".legend-item")
          .data(legendData, function(d) { return d.parent; });

        legendItems.exit().remove();

        var legendEnter = legendItems.enter()
          .append("div")
          .attr("class", "legend-item")
          .attr("role", "listitem");

        legendEnter.append("span")
          .attr("class", "legend-square");

        legendEnter.append("span")
          .attr("class", "legend-label");

        legendItems = legendEnter.merge(legendItems);

        legendItems.select(".legend-square")
          .style("background-color", function(d) { return d.color; });

        legendItems.select(".legend-label")
          .text(function(d) { return d.parent; });
      }

      function isColorDark(hexColor) {
        if (!hexColor) {
          return false;
        }

        var hex = hexColor.trim().replace("#", "");
        if (hex.length === 3) {
          hex = hex.split("").map(function(ch) { return ch + ch; }).join("");
        }

        if (hex.length !== 6) {
          return false;
        }

        var r = parseInt(hex.slice(0, 2), 16) / 255;
        var g = parseInt(hex.slice(2, 4), 16) / 255;
        var b = parseInt(hex.slice(4, 6), 16) / 255;

        var convert = function(channel) {
          return channel <= 0.03928 ? channel / 12.92 : Math.pow((channel + 0.055) / 1.055, 2.4);
        };

        var lum = 0.2126 * convert(r) + 0.7152 * convert(g) + 0.0722 * convert(b);
        return lum < 0.55;
      }

      function getContrastingTextColor(hexColor) {
        return isColorDark(hexColor) ? "#ffffff" : "#1b1d21";
      }

      function wrapText(selection, radius) {
        var diameter = radius * 2;
        var maxWidth = diameter * 0.85;
        var maxHeight = diameter * 0.85;
        var lineHeightMultiplier = 1.15;
        var minFontSize = 8;

        selection.each(function(d) {
          var text = d3.select(this);
          var label = (d.id || "").trim();

          text.selectAll("tspan").remove();
          text.text("");

          if (!label) {
            return;
          }

          var words = label.split(/\s+/).filter(function(word) { return word.length; });
          if (!words.length) {
            text.append("tspan")
              .attr("x", 0)
              .attr("y", 0)
              .text(label);
            return;
          }

          var maxFontSize = Math.min(16, radius * 0.45);
          var startingFontSize = Math.max(Math.round(maxFontSize), minFontSize);
          var bestFit = null;

          for (var fontSize = startingFontSize; fontSize >= minFontSize; fontSize -= 1) {
            var layout = layoutLines(text, words, fontSize, lineHeightMultiplier, maxWidth);
            bestFit = layout;
            var totalHeight = layout.lines.length * layout.lineHeight;

            if (layout.maxLineWidth <= maxWidth && totalHeight <= maxHeight) {
              break;
            }
          }

          if (!bestFit) {
            bestFit = {
              lines: [label],
              fontSize: minFontSize,
              lineHeight: Math.round(minFontSize * lineHeightMultiplier)
            };
          }

          text.style("font-size", bestFit.fontSize + "px");
          text.selectAll("tspan").remove();

          var offset = (bestFit.lines.length - 1) * bestFit.lineHeight / 2;

          bestFit.lines.forEach(function(line, index) {
            text.append("tspan")
              .attr("x", 0)
              .attr("y", -offset + index * bestFit.lineHeight)
              .text(line);
          });
        });

        function layoutLines(text, words, fontSize, lineHeightMultiplier, maxWidth) {
          text.style("font-size", fontSize + "px");
          text.selectAll("tspan").remove();

          var lines = [];
          var currentLine = [];
          var maxLineWidth = 0;

          words.forEach(function(word) {
            currentLine.push(word);
            var tester = text.append("tspan")
              .attr("x", 0)
              .attr("y", 0)
              .text(currentLine.join(" "));
            var lineLength = tester.node().getComputedTextLength();
            tester.remove();

            if (lineLength > maxWidth && currentLine.length > 1) {
              currentLine.pop();
              var finalized = currentLine.join(" ");
              var measureFinal = text.append("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(finalized);
              var finalLength = measureFinal.node().getComputedTextLength();
              measureFinal.remove();

              lines.push(finalized);
              maxLineWidth = Math.max(maxLineWidth, finalLength);

              currentLine = [word];
              var measureWord = text.append("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(word);
              var wordLength = measureWord.node().getComputedTextLength();
              measureWord.remove();
              maxLineWidth = Math.max(maxLineWidth, wordLength);
            } else {
              maxLineWidth = Math.max(maxLineWidth, lineLength);
            }
          });

          if (currentLine.length) {
            var finalLine = currentLine.join(" ");
            var finalTester = text.append("tspan")
              .attr("x", 0)
              .attr("y", 0)
              .text(finalLine);
            var finalLineLength = finalTester.node().getComputedTextLength();
            finalTester.remove();

            lines.push(finalLine);
            maxLineWidth = Math.max(maxLineWidth, finalLineLength);
          }

          var lineHeight = Math.max(Math.round(fontSize * lineHeightMultiplier), Math.ceil(fontSize));

          return {
            lines: lines,
            fontSize: fontSize,
            lineHeight: lineHeight,
            maxLineWidth: maxLineWidth
          };
        }
      }

    </script>

  </body>

</html>
